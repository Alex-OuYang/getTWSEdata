# Download Basic Data
#source("DownloadBasicData.R")
# Show Basic Data
source("ShowBasicData.R")
# Analysis
#source("BasicData.R")
rm(list=ls())
projectPathStr="C:/Users/alex1/Desktop/getTWSEdata"
stockno="2882"
nowDateSplit=strsplit(as.character(Sys.Date()),"-")
nowDate=paste0(nowDateSplit[[1]][1],nowDateSplit[[1]][2],nowDateSplit[[1]][3])
startDate="20190901"
endDate=nowDate
isDownloadData=TRUE
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("2882","1001")
stockno
length(stockno)
for(i in c(1:length(stockno))){
i
}
for(i in c(1:length(stockno))){
i
}
for(i in 1:length(stockno)){
i
}
i
for(i in 1:length(stockno)){
view(i)
}
for(i in 1:length(stockno)){
View(i)
}
for(i in 1:length(stockno)){
stockno[i]
}
stockno[i]
stockno[1]
stockno[2]
rm(list=ls())
projectPathStr="C:/Users/alex1/Desktop/getTWSEdata"
stockno="2882"
nowDateSplit=strsplit(as.character(Sys.Date()),"-")
nowDate=paste0(nowDateSplit[[1]][1],nowDateSplit[[1]][2],nowDateSplit[[1]][3])
startDate="20190901"
endDate=nowDate
isDownloadData=TRUE
# Download Basic Data
source("DownloadBasicData.R")
# Show Basic Data
#source("ShowBasicData.R")
# Analysis
#source("BasicData.R")
rm(list=ls())
projectPathStr="C:/Users/alex1/Desktop/getTWSEdata"
stockno="2882"
nowDateSplit=strsplit(as.character(Sys.Date()),"-")
nowDate=paste0(nowDateSplit[[1]][1],nowDateSplit[[1]][2],nowDateSplit[[1]][3])
startDate="20190901"
endDate=nowDate
isDownloadData=TRUE
# Download Basic Data
#source("DownloadBasicData.R")
# Show Basic Data
#source("ShowBasicData.R")
# Analysis
#source("BasicData.R")
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("2882","1001")
source("DateDiff.R")
for(i in 1:length(stockno)){
source("GetStock.R")
if(isDownloadData==TRUE){
write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"StockData/",stockno[i],".csv"))
}
}
View(days)
View(days)
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("2882","1001")
source("DateDiff.R")
for(i in 1:length(stockno)){
stockno=stockno[i]
source("GetStock.R")
if(isDownloadData==TRUE){
write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"StockData/",stockno[i],".csv"))
}
}
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("2882","1001")
source("DateDiff.R")
for(i in 1:length(stockno)){
stockno=stockno[i]
source("GetStock.R")
if(isDownloadData==TRUE){
write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
}
}
for(i in 1:length(stockno)){
stockno=stockno[i]
print(stockno)
source("GetStock.R")
if(isDownloadData==TRUE){
write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
}
}
stockno
for(i in c(1:length(stockno))){
stockno=stockno[i]
print(stockno)
source("GetStock.R")
if(isDownloadData==TRUE){
write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
}
}
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("2882","1001")
source("DateDiff.R")
for(i in c(1:length(stockno))){
stockno=stockno[i]
print(stockno)
source("GetStock.R")
if(isDownloadData==TRUE){
write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
}
}
stockno[2]
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("2882","1001")
source("DateDiff.R")
for(i in c(1:length(stockno))){
print(i)
stockno=stockno[i]
print(stockno)
source("GetStock.R")
if(isDownloadData==TRUE){
write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
}
}
stockno=c("2882","1001")
stockno=c("2882","1001")
stockno[2]
stockno[1]
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("2882","1001")
source("DateDiff.R")
for(i in 1:length(stockno)){
print(i)
stockno=stockno[i]
print(stockno)
#source("GetStock.R")
#if(isDownloadData==TRUE){
#  write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
#}
}
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("2882","1001")
source("DateDiff.R")
for(i in stockno){
print(i)
stockno=stockno[i]
print(stockno)
#source("GetStock.R")
#if(isDownloadData==TRUE){
#  write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
#}
}
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("2882","1001")
source("DateDiff.R")
for(i in stockno){
print(i)
stockno=i
print(stockno)
#source("GetStock.R")
#if(isDownloadData==TRUE){
#  write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
#}
}
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("2882","1001")
source("DateDiff.R")
for(i in stockno){
source("GetStock.R")
if(isDownloadData==TRUE){
write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
}
}
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("2882","1001")
source("DateDiff.R")
for(i in stockno){
stockno=i
source("GetStock.R")
if(isDownloadData==TRUE){
write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
}
}
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("1001")
source("DateDiff.R")
for(i in stockno){
stockno=i
source("GetStock.R")
if(isDownloadData==TRUE){
write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
}
}
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("2330")
source("DateDiff.R")
for(i in stockno){
stockno=i
source("GetStock.R")
if(isDownloadData==TRUE){
write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
}
}
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("1002")
source("DateDiff.R")
for(i in stockno){
stockno=i
source("GetStock.R")
if(isDownloadData==TRUE){
write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
}
}
stockurl
View(days)
days(2)
days(10)
rm(list=ls())
projectPathStr="C:/Users/alex1/Desktop/getTWSEdata"
stockno="2882"
nowDateSplit=strsplit(as.character(Sys.Date()),"-")
nowDate=paste0(nowDateSplit[[1]][1],nowDateSplit[[1]][2],nowDateSplit[[1]][3])
startDate="20190901"
endDate=nowDate
isDownloadData=TRUE
# Download Basic Data
#source("DownloadBasicData.R")
# Show Basic Data
#source("ShowBasicData.R")
# Analysis
#source("BasicData.R")
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("1002")
source("DateDiff.R")
source("GetStock.R")
for(i in stockno){
stockno=i
stockFunc(stockno,datediff)
if(isDownloadData==TRUE){
write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
}
}
View(stockFunc)
View(datediff)
rm(list=ls())
projectPathStr="C:/Users/alex1/Desktop/getTWSEdata"
stockno="2882"
nowDateSplit=strsplit(as.character(Sys.Date()),"-")
nowDate=paste0(nowDateSplit[[1]][1],nowDateSplit[[1]][2],nowDateSplit[[1]][3])
startDate="20190901"
endDate=nowDate
isDownloadData=TRUE
setwd(paste0(projectPathStr,"/BasicData") )
source("DateDiff.R")
source("GetStock.R")
datediffFunc(startDate = startDate,endDate = endDate)
datediff
View(datediffFunc)
datediffFunc(startDate,endDate)
print(datediffFunc(startDate,endDate))
print(datediffFunc("20190101","20190922"))
rm(list=ls())
projectPathStr="C:/Users/alex1/Desktop/getTWSEdata"
stockno="2882"
nowDateSplit=strsplit(as.character(Sys.Date()),"-")
nowDate=paste0(nowDateSplit[[1]][1],nowDateSplit[[1]][2],nowDateSplit[[1]][3])
startDate="20190901"
endDate=nowDate
isDownloadData=TRUE
# Download Basic Data
#source("DownloadBasicData.R")
# Show Basic Data
#source("ShowBasicData.R")
# Analysis
#source("BasicData.R")
setwd(paste0(projectPathStr,"/BasicData") )
source("DateDiff.R")
source("GetStock.R")
datediffFunc(startDate = startDate,endDate = endDate)
rm(list=ls())
projectPathStr="C:/Users/alex1/Desktop/getTWSEdata"
stockno="2882"
nowDateSplit=strsplit(as.character(Sys.Date()),"-")
nowDate=paste0(nowDateSplit[[1]][1],nowDateSplit[[1]][2],nowDateSplit[[1]][3])
startDate="20190101"
endDate=nowDate
isDownloadData=TRUE
# Download Basic Data
#source("DownloadBasicData.R")
# Show Basic Data
#source("ShowBasicData.R")
# Analysis
#source("BasicData.R")
setwd(paste0(projectPathStr,"/BasicData") )
source("DateDiff.R")
source("GetStock.R")
datediffFunc(startDate = startDate,endDate = endDate)
datediffFunc=function(startDate,endDate){
#開始日期
a=as.numeric(substr(startDate,1,4))
b=as.numeric(substr(startDate,5,6))
c=01
#現在日期
a1=as.numeric(substr(endDate,1,4))
b1=as.numeric(substr(endDate,5,6))
c1=as.numeric(substr(endDate,7,8))
datediff=c()
days=function(days){
if(days<10){
days=as.character(paste0(0,days))
}
return(days)
}
mon=function(mon){
if(mon<10){
mon=as.character(paste0(0,mon))
}
return(mon)
}
year=c(a:a1)
if(length(year)>1){
for(i in year){
if(i!=year[length(year)]){#非最後一年
if(i==head(year,1)){
for(k in c(b:12)){
datediff=rbind(datediff,paste0(i,mon(k),days(c)))
}
}else{
for(l in c(1:12)){
datediff=rbind(datediff,paste0(i,mon(l),days(c)))
}
}
}else if(i==year[length(year)]){#最後一年
for(j in c(1:b1)){
datediff=rbind(datediff,paste0(i,mon(j),days(c)))
}
}
}
}else{
for(j in c(b:b1)){
datediff=rbind(datediff,paste0(a,mon(j),days(c)))
}
}
#print(datediff)
return(datediff)
}
datediff
datediffFunc
print(a)
a=datediffFunc(startDate = startDate,endDate = endDate)
print(a)
setwd(paste0(projectPathStr,"/BasicData") )
source("DateDiff.R")
source("GetStock.R")
datediff=datediffFunc(startDate = startDate,endDate = endDate)
stockFunc(stockno = stockno,datediff = datediff)
chartSeries(STOCK,up.col = "red",dn.col = "green",theme = "white",name = stockno)
rm(list=ls())
projectPathStr="C:/Users/alex1/Desktop/getTWSEdata"
stockno="2882"
nowDateSplit=strsplit(as.character(Sys.Date()),"-")
nowDate=paste0(nowDateSplit[[1]][1],nowDateSplit[[1]][2],nowDateSplit[[1]][3])
startDate="20190101"
endDate=nowDate
isDownloadData=TRUE
# Download Basic Data
#source("DownloadBasicData.R")
# Show Basic Data
#source("ShowBasicData.R")
# Analysis
#source("BasicData.R")
setwd(paste0(projectPathStr,"/BasicData") )
source("DateDiff.R")
source("GetStock.R")
datediff=datediffFunc(startDate = startDate,endDate = endDate)
STOCK=stockFunc(stockno = stockno,datediff = datediff)
View(STOCK)
chartSeries(STOCK,up.col = "red",dn.col = "green",theme = "white",name = stockno)
chartSeries(STOCK,up.col = "red",dn.col = "green",theme = "white",name = stockno)
rm(list=ls())
projectPathStr="C:/Users/alex1/Desktop/getTWSEdata"
stockno="2882"
nowDateSplit=strsplit(as.character(Sys.Date()),"-")
nowDate=paste0(nowDateSplit[[1]][1],nowDateSplit[[1]][2],nowDateSplit[[1]][3])
startDate="20190101"
endDate=nowDate
isDownloadData=TRUE
setwd(paste0(projectPathStr,"/BasicData") )
source("FuncDateDiff.R")
source("FuncGetStock.R")
datediff=datediffFunc(startDate = startDate,endDate = endDate)
STOCK=stockFunc(stockno = stockno,datediff = datediff)
rm(list=ls())
projectPathStr="C:/Users/alex1/Desktop/getTWSEdata"
stockno="2882"
nowDateSplit=strsplit(as.character(Sys.Date()),"-")
nowDate=paste0(nowDateSplit[[1]][1],nowDateSplit[[1]][2],nowDateSplit[[1]][3])
startDate="20190101"
endDate=nowDate
isDownloadData=TRUE
# Download Basic Data
#source("DownloadBasicData.R")
# Show Basic Data
#source("ShowBasicData.R")
# Analysis
#source("BasicData.R")
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("2882","2498")
source("FuncDateDiff.R")
source("FuncGetStock.R")
for(i in stockno){
stockno=i
datediff=datediffFunc(startDate = startDate,endDate = endDate)
STOCK=stockFunc(stockno = stockno,datediff = datediff)
if(isDownloadData==TRUE){
write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
}
}
rm(list=ls())
projectPathStr="C:/Users/alex1/Desktop/getTWSEdata"
stockno="2882"
nowDateSplit=strsplit(as.character(Sys.Date()),"-")
nowDate=paste0(nowDateSplit[[1]][1],nowDateSplit[[1]][2],nowDateSplit[[1]][3])
startDate="20190101"
endDate=nowDate
isDownloadData=TRUE
# Download Basic Data
#source("DownloadBasicData.R")
# Show Basic Data
#source("ShowBasicData.R")
# Analysis
#source("BasicData.R")
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("2882","2498")
source("FuncDateDiff.R")
source("FuncGetStock.R")
for(i in stockno){
print(i)
datediff=datediffFunc(startDate = startDate,endDate = endDate)
STOCK=stockFunc(stockno = i,datediff = datediff)
if(isDownloadData==TRUE){
write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
}
}
rm(list=ls())
projectPathStr="C:/Users/alex1/Desktop/getTWSEdata"
stockno="2882"
nowDateSplit=strsplit(as.character(Sys.Date()),"-")
nowDate=paste0(nowDateSplit[[1]][1],nowDateSplit[[1]][2],nowDateSplit[[1]][3])
startDate="20190901"
endDate=nowDate
isDownloadData=TRUE
# Download Basic Data
#source("DownloadBasicData.R")
# Show Basic Data
#source("ShowBasicData.R")
# Analysis
#source("BasicData.R")
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("2882","2498")
source("FuncDateDiff.R")
source("FuncGetStock.R")
for(i in stockno){
print(i)
datediff=datediffFunc(startDate = startDate,endDate = endDate)
STOCK=stockFunc(stockno = i,datediff = datediff)
if(isDownloadData==TRUE){
write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
}
}
rm(list=ls())
projectPathStr="C:/Users/alex1/Desktop/getTWSEdata"
stockno="2882"
nowDateSplit=strsplit(as.character(Sys.Date()),"-")
nowDate=paste0(nowDateSplit[[1]][1],nowDateSplit[[1]][2],nowDateSplit[[1]][3])
startDate="20190901"
endDate=nowDate
isDownloadData=TRUE
# Download Basic Data
#source("DownloadBasicData.R")
# Show Basic Data
#source("ShowBasicData.R")
# Analysis
#source("BasicData.R")
setwd(paste0(projectPathStr,"/BasicData") )
stockno=c("2882","2498")
source("FuncDateDiff.R")
source("FuncGetStock.R")
for(i in stockno){
print(i)
datediff=datediffFunc(startDate = startDate,endDate = endDate)
STOCK=stockFunc(stockno = i,datediff = datediff)
if(isDownloadData==TRUE){
write.csv(as.matrix(STOCK), file = paste0(projectPathStr,"/StockData/",stockno[i],".csv"))
}
}
