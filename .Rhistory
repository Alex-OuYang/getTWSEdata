}
mon=function(mon){
if(mon<10){
mon=as.character(paste0(0,mon))
}
return(mon)
}
while( a<=a1){
datediff=rbind(datediff,paste0(a,mon(b),days(c)))
b=b+1
if(b==12){
datediff=rbind(datediff,paste0(a,mon(b),days(c)))
a=a+1
b=01
}else if(a==a1 && b==b1){
datediff=rbind(datediff,paste0(a,mon(b),days(c)))
break
}
}
datediff
setwd("C:/Users/alex1/Desktop/stock")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="2000/09/01"
source(datediff.r)
setwd("C:/Users/alex1/Desktop/stock")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="2000/09/01"
source(datediff.R)
stockurl=paste0("http://www.twse.com.tw/exchangeReport/STOCK_DAY?date=",datestr,"&stockNo=",stockno)
urldata=url(stockurl)
stock=fromJSON(urldata,flatten=T)
STK=cbind(stock$data[,1],stock$data[,4],stock$data[,5],stock$data[,6],stock$data[,7],stock$data[,3])
STK[,2]=as.numeric(STK[,2])#O
STK[,3]=as.numeric(STK[,3])#P
STK[,4]=as.numeric(STK[,4])#C
STK[,5]=as.numeric(STK[,5])#L
STK[,6]=as.numeric(gsub(",","",STK[,6]))#V
timeCharVector = as.character(STK[,1])
TimeY=substr(timeCharVector,1,3)
TimeY=as.numeric(TimeY)+1911
timeCharVector=paste0(TimeY,substr(timeCharVector,4,9))
timeVector=strptime(timeCharVector,"%Y/%m/%d",tz=Sys.timezone())
timeVector=as.POSIXct(timeVector)
STK=cbind(as.numeric(STK[,2]),as.numeric(STK[,3]),as.numeric(STK[,4]),as.numeric(STK[,5]),as.numeric(STK[,6]))
STK=xts(STK,as.POSIXct(timeVector))
colnames(STK)=c("Open","High","Low","Close","Volume")
# View(STK)
chartSeries(STK,up.col = "red",dn.col = "green",theme = "white",name = stockno)
setwd("C:/Users/alex1/Desktop/stock")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="20000901"
source(datediff.R)
stockurl=paste0("http://www.twse.com.tw/exchangeReport/STOCK_DAY?date=",datestr,"&stockNo=",stockno)
urldata=url(stockurl)
stock=fromJSON(urldata,flatten=T)
STK=cbind(stock$data[,1],stock$data[,4],stock$data[,5],stock$data[,6],stock$data[,7],stock$data[,3])
STK[,2]=as.numeric(STK[,2])#O
STK[,3]=as.numeric(STK[,3])#P
STK[,4]=as.numeric(STK[,4])#C
STK[,5]=as.numeric(STK[,5])#L
STK[,6]=as.numeric(gsub(",","",STK[,6]))#V
timeCharVector = as.character(STK[,1])
TimeY=substr(timeCharVector,1,3)
TimeY=as.numeric(TimeY)+1911
timeCharVector=paste0(TimeY,substr(timeCharVector,4,9))
timeVector=strptime(timeCharVector,"%Y/%m/%d",tz=Sys.timezone())
timeVector=as.POSIXct(timeVector)
STK=cbind(as.numeric(STK[,2]),as.numeric(STK[,3]),as.numeric(STK[,4]),as.numeric(STK[,5]),as.numeric(STK[,6]))
STK=xts(STK,as.POSIXct(timeVector))
colnames(STK)=c("Open","High","Low","Close","Volume")
# View(STK)
chartSeries(STK,up.col = "red",dn.col = "green",theme = "white",name = stockno)
source(datediff.R)
source("datediff.R")
setwd("C:/Users/alex1/Desktop/stock")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="20000901"
source("datediff.R")
source("datediff.r")
setwd("C:/Users/alex1/Desktop/stock")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="20000901"
source("datediff.R")
datestr
substr(datediff,1,4)
setwd("C:/Users/alex1/Desktop/stock")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="20000901"
#開始日期
a=substr(datestr,1,4)
b=substr(datestr,5,2)
b=substr(datestr,5,2)
b
b=substr(datestr,1,5)
b
b=substr(datestr,5,1)
b
?substr
substr("abcdef", 2, 4)
substr("abcdef", 3, 4)
b=substr(datestr,5,6)
b
setwd("C:/Users/alex1/Desktop/stock")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="20000901"
source("datediff.R")
#開始日期
a=substr(datestr,1,4)
b=substr(datestr,5,6)
c=01
#現在日期
now=Sys.Date()
nowstr=strsplit(as.character(Sys.Date()),"-")
a1=nowstr[[1]][1]
b1=nowstr[[1]][2]
c1=01
datediff=c()
days=function(days){
if(days<10){
days=as.character(paste0(0,days))
}
return(days)
}
mon=function(mon){
if(mon<10){
mon=as.character(paste0(0,mon))
}
return(mon)
}
while( a<=a1){
datediff=rbind(datediff,paste0(a,mon(b),days(c)))
b=b+1
if(b==12){
datediff=rbind(datediff,paste0(a,mon(b),days(c)))
a=a+1
b=01
}else if(a==a1 && b==b1){
datediff=rbind(datediff,paste0(a,mon(b),days(c)))
break
}
}
View(nowstr)
#開始日期
a=substr(datestr,1,4)
b=substr(datestr,5,6)
c=01
#現在日期
now=Sys.Date()
nowstr=strsplit(as.character(Sys.Date()),"-")
a1=nowstr[[1]][1]
b1=nowstr[[1]][2]
c1=01
datediff=c()
days=function(days){
if(days<10){
days=as.character(paste0(0,days))
}
return(days)
}
mon=function(mon){
if(mon<10){
mon=as.character(paste0(0,mon))
}
return(mon)
}
while( a<=a1){
datediff=rbind(datediff,paste0(a,mon(b),days(c)))
b=as.numeric(b)+1
if(b==12){
datediff=rbind(datediff,paste0(a,mon(b),days(c)))
a=a+1
b=01
}else if(a==a1 && b==b1){
datediff=rbind(datediff,paste0(a,mon(b),days(c)))
break
}
}
datediff
setwd("C:/Users/alex1/Desktop/stock")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="20000901"
source("datediff.R")
#開始日期
a=substr(datestr,1,4)
b=substr(datestr,5,6)
c=01
#現在日期
now=Sys.Date()
nowstr=strsplit(as.character(Sys.Date()),"-")
a1=nowstr[[1]][1]
b1=nowstr[[1]][2]
c1=01
datediff=c()
days=function(days){
if(days<10){
days=as.character(paste0(0,days))
}
return(days)
}
mon=function(mon){
if(mon<10){
mon=as.character(paste0(0,mon))
}
return(mon)
}
while( a<=a1){
datediff=rbind(datediff,paste0(a,mon(b),days(c)))
b=as.numeric(b)+1
if(b==12){
datediff=rbind(datediff,paste0(a,mon(b),days(c)))
a=as.numeric(a)+1
b=01
}else if(a==a1 && b==b1){
datediff=rbind(datediff,paste0(a,mon(b),days(c)))
break
}
}
datediff
setwd("C:/Users/alex1/Desktop/stock")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="20000901"
source("datediff.R")
View(datediff)
setwd("C:/Users/alex1/Desktop/stock")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="20180901"
source("datediff.R")
View(datediff)
#開始日期
a=substr(datestr,1,4)
b=substr(datestr,5,6)
a
b
setwd("C:/Users/alex1/Desktop/stock")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="20180901"
source("datediff.R")
View(datediff)
date.length
datediff.length
datediff
typeof(datediff)
datediff=as.matrix(datediff)
datediff
typeof(datediff)
nrow(datediff)
for(i in nrow(datediff)){
print(i)
}
for(i in c(1:nrow(datediff))){
print(i)
}
for(i in c(1:nrow(datediff))){
print(datediff[i,])
}
setwd("C:/Users/alex1/Desktop/stock")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="20180901"
source("datediff.R")
datediff=as.matrix(datediff)
STOCK=c()
for(i in c(1:nrow(datediff))){
print(datediff[i,])
stockurl=paste0("http://www.twse.com.tw/exchangeReport/STOCK_DAY?date=",datediff[i,],"&stockNo=",stockno)
urldata=url(stockurl)
stock=fromJSON(urldata,flatten=T)
STK=cbind(stock$data[,1],stock$data[,4],stock$data[,5],stock$data[,6],stock$data[,7],stock$data[,3])
STOCK=rbind(STOCK,STK)
}
STOCK
setwd("C:/Users/alex1/Desktop/stock")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="20180901"
source("datediff.R")
datediff=as.matrix(datediff)
STOCK=c()
for(i in c(1:nrow(datediff))){
print(datediff[i,])
stockurl=paste0("http://www.twse.com.tw/exchangeReport/STOCK_DAY?date=",datediff[i,],"&stockNo=",stockno)
urldata=url(stockurl)
stock=fromJSON(urldata,flatten=T)
STK=cbind(stock$data[,1],stock$data[,4],stock$data[,5],stock$data[,6],stock$data[,7],stock$data[,3])
STOCK=rbind(STOCK,STK)
}
# stockurl=paste0("http://www.twse.com.tw/exchangeReport/STOCK_DAY?date=",datestr,"&stockNo=",stockno)
# urldata=url(stockurl)
# stock=fromJSON(urldata,flatten=T)
#
# STK=cbind(stock$data[,1],stock$data[,4],stock$data[,5],stock$data[,6],stock$data[,7],stock$data[,3])
STOCK[,2]=as.numeric(STOCK[,2])#O
STOCK[,3]=as.numeric(STOCK[,3])#P
STOCK[,4]=as.numeric(STOCK[,4])#C
STOCK[,5]=as.numeric(STOCK[,5])#L
STOCK[,6]=as.numeric(gsub(",","",STOCK[,6]))#V
timeCharVector = as.character(STOCK[,1])
TimeY=substr(timeCharVector,1,3)
TimeY=as.numeric(TimeY)+1911
timeCharVector=paste0(TimeY,substr(timeCharVector,4,9))
timeVector=strptime(timeCharVector,"%Y/%m/%d",tz=Sys.timezone())
timeVector=as.POSIXct(timeVector)
STOCK=cbind(as.numeric(STOCK[,2]),as.numeric(STOCK[,3]),as.numeric(STOCK[,4]),as.numeric(STOCK[,5]),as.numeric(STOCK[,6]))
STOCK=xts(STOCK,as.POSIXct(timeVector))
colnames(STK)=c("Open","High","Low","Close","Volume")
setwd("C:/Users/alex1/Desktop/stock")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="20180901"
source("datediff.R")
datediff=as.matrix(datediff)
STOCK=c()
for(i in c(1:nrow(datediff))){
print(datediff[i,])
stockurl=paste0("http://www.twse.com.tw/exchangeReport/STOCK_DAY?date=",datediff[i,],"&stockNo=",stockno)
urldata=url(stockurl)
stock=fromJSON(urldata,flatten=T)
STK=cbind(stock$data[,1],stock$data[,4],stock$data[,5],stock$data[,6],stock$data[,7],stock$data[,3])
STOCK=rbind(STOCK,STK)
}
# stockurl=paste0("http://www.twse.com.tw/exchangeReport/STOCK_DAY?date=",datestr,"&stockNo=",stockno)
# urldata=url(stockurl)
# stock=fromJSON(urldata,flatten=T)
#
# STK=cbind(stock$data[,1],stock$data[,4],stock$data[,5],stock$data[,6],stock$data[,7],stock$data[,3])
STOCK[,2]=as.numeric(STOCK[,2])#O
STOCK[,3]=as.numeric(STOCK[,3])#P
STOCK[,4]=as.numeric(STOCK[,4])#C
STOCK[,5]=as.numeric(STOCK[,5])#L
STOCK[,6]=as.numeric(gsub(",","",STOCK[,6]))#V
timeCharVector = as.character(STOCK[,1])
TimeY=substr(timeCharVector,1,3)
TimeY=as.numeric(TimeY)+1911
timeCharVector=paste0(TimeY,substr(timeCharVector,4,9))
timeVector=strptime(timeCharVector,"%Y/%m/%d",tz=Sys.timezone())
timeVector=as.POSIXct(timeVector)
STOCK=cbind(as.numeric(STOCK[,2]),as.numeric(STOCK[,3]),as.numeric(STOCK[,4]),as.numeric(STOCK[,5]),as.numeric(STOCK[,6]))
STOCK=xts(STOCK,as.POSIXct(timeVector))
colnames(STOCK)=c("Open","High","Low","Close","Volume")
View(STK)
View(STOCK)
chartSeries(STOCK,up.col = "red",dn.col = "green",theme = "white",name = stockno)
setwd("C:/Users/alex1/Desktop/stock")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="20180101"
source("datediff.R")
datediff=as.matrix(datediff)
STOCK=c()
for(i in c(1:nrow(datediff))){
print(datediff[i,])
stockurl=paste0("http://www.twse.com.tw/exchangeReport/STOCK_DAY?date=",datediff[i,],"&stockNo=",stockno)
urldata=url(stockurl)
stock=fromJSON(urldata,flatten=T)
STK=cbind(stock$data[,1],stock$data[,4],stock$data[,5],stock$data[,6],stock$data[,7],stock$data[,3])
STOCK=rbind(STOCK,STK)
}
# stockurl=paste0("http://www.twse.com.tw/exchangeReport/STOCK_DAY?date=",datestr,"&stockNo=",stockno)
# urldata=url(stockurl)
# stock=fromJSON(urldata,flatten=T)
#
# STK=cbind(stock$data[,1],stock$data[,4],stock$data[,5],stock$data[,6],stock$data[,7],stock$data[,3])
STOCK[,2]=as.numeric(STOCK[,2])#O
STOCK[,3]=as.numeric(STOCK[,3])#P
STOCK[,4]=as.numeric(STOCK[,4])#C
STOCK[,5]=as.numeric(STOCK[,5])#L
STOCK[,6]=as.numeric(gsub(",","",STOCK[,6]))#V
timeCharVector = as.character(STOCK[,1])
TimeY=substr(timeCharVector,1,3)
TimeY=as.numeric(TimeY)+1911
timeCharVector=paste0(TimeY,substr(timeCharVector,4,9))
timeVector=strptime(timeCharVector,"%Y/%m/%d",tz=Sys.timezone())
timeVector=as.POSIXct(timeVector)
STOCK=cbind(as.numeric(STOCK[,2]),as.numeric(STOCK[,3]),as.numeric(STOCK[,4]),as.numeric(STOCK[,5]),as.numeric(STOCK[,6]))
STOCK=xts(STOCK,as.POSIXct(timeVector))
colnames(STOCK)=c("Open","High","Low","Close","Volume")
# View(STOCK)
chartSeries(STOCK,up.col = "red",dn.col = "green",theme = "white",name = stockno)
setwd("C:/Users/alex1/Desktop/stock")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="20180501"
source("datediff.R")
datediff=as.matrix(datediff)
STOCK=c()
for(i in c(1:nrow(datediff))){
stockurl=paste0("http://www.twse.com.tw/exchangeReport/STOCK_DAY?date=",datediff[i,],"&stockNo=",stockno)
urldata=url(stockurl)
stock=fromJSON(urldata,flatten=T)
STK=cbind(stock$data[,1],stock$data[,4],stock$data[,5],stock$data[,6],stock$data[,7],stock$data[,3])
STOCK=rbind(STOCK,STK)
}
# stockurl=paste0("http://www.twse.com.tw/exchangeReport/STOCK_DAY?date=",datestr,"&stockNo=",stockno)
# urldata=url(stockurl)
# stock=fromJSON(urldata,flatten=T)
#
# STK=cbind(stock$data[,1],stock$data[,4],stock$data[,5],stock$data[,6],stock$data[,7],stock$data[,3])
STOCK[,2]=as.numeric(STOCK[,2])#O
STOCK[,3]=as.numeric(STOCK[,3])#P
STOCK[,4]=as.numeric(STOCK[,4])#C
STOCK[,5]=as.numeric(STOCK[,5])#L
STOCK[,6]=as.numeric(gsub(",","",STOCK[,6]))#V
timeCharVector = as.character(STOCK[,1])
TimeY=substr(timeCharVector,1,3)
TimeY=as.numeric(TimeY)+1911
timeCharVector=paste0(TimeY,substr(timeCharVector,4,9))
timeVector=strptime(timeCharVector,"%Y/%m/%d",tz=Sys.timezone())
timeVector=as.POSIXct(timeVector)
STOCK=cbind(as.numeric(STOCK[,2]),as.numeric(STOCK[,3]),as.numeric(STOCK[,4]),as.numeric(STOCK[,5]),as.numeric(STOCK[,6]))
STOCK=xts(STOCK,as.POSIXct(timeVector))
colnames(STOCK)=c("Open","High","Low","Close","Volume")
# View(STOCK)
chartSeries(STOCK,up.col = "red",dn.col = "green",theme = "white",name = stockno)
View(STOCK)
SMA(STOCK,n=10)
?SMA
chartSeries(STOCK,up.col = "red",dn.col = "green",theme = "white",name = stockno)
SMA(STOCK,n=10)
SMA(STOCK[,4],n=10)
Sys.setenv(TZ = "UTC")
SMA(STOCK[,4],n=10)
setwd("C:/Users/alex1/Desktop/stock")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="20180701"
source("datediff.R")
datediff=as.matrix(datediff)
STOCK=c()
for(i in c(1:nrow(datediff))){
stockurl=paste0("http://www.twse.com.tw/exchangeReport/STOCK_DAY?date=",datediff[i,],"&stockNo=",stockno)
urldata=url(stockurl)
stock=fromJSON(urldata,flatten=T)
STK=cbind(stock$data[,1],stock$data[,4],stock$data[,5],stock$data[,6],stock$data[,7],stock$data[,3])
STOCK=rbind(STOCK,STK)
}
STOCK[,2]=as.numeric(STOCK[,2])#O
STOCK[,3]=as.numeric(STOCK[,3])#P
STOCK[,4]=as.numeric(STOCK[,4])#C
STOCK[,5]=as.numeric(STOCK[,5])#L
STOCK[,6]=as.numeric(gsub(",","",STOCK[,6]))#V
timeCharVector = as.character(STOCK[,1])
TimeY=substr(timeCharVector,1,3)
TimeY=as.numeric(TimeY)+1911
timeCharVector=paste0(TimeY,substr(timeCharVector,4,9))
timeVector=strptime(timeCharVector,"%Y/%m/%d",tz=Sys.timezone())
timeVector=as.POSIXct(timeVector)
STOCK=cbind(as.numeric(STOCK[,2]),as.numeric(STOCK[,3]),as.numeric(STOCK[,4]),as.numeric(STOCK[,5]),as.numeric(STOCK[,6]))
STOCK=xts(STOCK,as.POSIXct(timeVector))
colnames(STOCK)=c("Open","High","Low","Close","Volume")
# View(STOCK)
chartSeries(STOCK,up.col = "red",dn.col = "green",theme = "white",name = stockno)
SMA(STOCK[,4],n=10)
setwd("C:/Users/alex1/Desktop/getTWSEdata")
setwd("C:/Users/alex1/Desktop/getTWSEdata")
library(quantmod)
library(jsonlite)
stockno="2330"
datestr="20180701"
source("datediff.R")
datediff=as.matrix(datediff)
STOCK=c()
for(i in c(1:nrow(datediff))){
stockurl=paste0("http://www.twse.com.tw/exchangeReport/STOCK_DAY?date=",datediff[i,],"&stockNo=",stockno)
urldata=url(stockurl)
stock=fromJSON(urldata,flatten=T)
STK=cbind(stock$data[,1],stock$data[,4],stock$data[,5],stock$data[,6],stock$data[,7],stock$data[,3])
STOCK=rbind(STOCK,STK)
}
STOCK[,2]=as.numeric(STOCK[,2])#O
STOCK[,3]=as.numeric(STOCK[,3])#P
STOCK[,4]=as.numeric(STOCK[,4])#C
STOCK[,5]=as.numeric(STOCK[,5])#L
STOCK[,6]=as.numeric(gsub(",","",STOCK[,6]))#V
timeCharVector = as.character(STOCK[,1])
TimeY=substr(timeCharVector,1,3)
TimeY=as.numeric(TimeY)+1911
timeCharVector=paste0(TimeY,substr(timeCharVector,4,9))
timeVector=strptime(timeCharVector,"%Y/%m/%d",tz=Sys.timezone())
timeVector=as.POSIXct(timeVector)
STOCK=cbind(as.numeric(STOCK[,2]),as.numeric(STOCK[,3]),as.numeric(STOCK[,4]),as.numeric(STOCK[,5]),as.numeric(STOCK[,6]))
STOCK=xts(STOCK,as.POSIXct(timeVector))
colnames(STOCK)=c("Open","High","Low","Close","Volume")
# View(STOCK)
chartSeries(STOCK,up.col = "red",dn.col = "green",theme = "white",name = stockno)
